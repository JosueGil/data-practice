---
title: "Vaccinations Visualization Report"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(scales)
library(ggthemes)
library(maps)
read <- function(n){
  read_csv(paste0("Vaccination-files/Vaccinations",as.character(n),".csv"),skip = 2)
}
stateselect <- function(n){#selecting the wanted variables of the vaccine data
  #Faster to rename the columns in the CSV file but used dplyr for practice.
  Vaccines <- n %>% select('State/Territory/Federal Entity', 'Total Doses Delivered','Total Doses Administered by State where Administered',
                           'Doses Administered per 100k by State where Administered','People with at least One Dose by State of Residence',
                           'Percent of Total Pop with at least One Dose by State of Residence','People Fully Vaccinated by State of Residence',
                           'Percent of Total Pop Fully Vaccinated by State of Residence')
  #Renaming the variables to shorter titles 
  Vaccines<- rename(Vaccines,state = 'State/Territory/Federal Entity',total_d = 'Total Doses Delivered',
                    total_a = 'Total Doses Administered by State where Administered', total_a_percent = 'Doses Administered per 100k by State where Administered',
                    one_dose = 'People with at least One Dose by State of Residence', one_dose_percent ='Percent of Total Pop with at least One Dose by State of Residence',
                    fully_vac = 'People Fully Vaccinated by State of Residence', fully_vac_percent ='Percent of Total Pop Fully Vaccinated by State of Residence')
  Vaccines <- Vaccines  %>% mutate(fully_vac_percent = as.numeric(fully_vac_percent),one_dose_percent = as.numeric(one_dose_percent)) %>%
    filter(!is.na(one_dose_percent), total_a > 80000)
}
addUnits <- function(n) {
  labels <- ifelse(n < 1000, n,  # less than thousands
                   ifelse(n < 1e6, paste0(round(n/1e3), 'k'),  # in thousands
                          ifelse(n < 1e9, paste0(round(n/1e6), 'M'))))  # in millions
  return(labels)
}
```

**Goal:** The goal of this report is to provide informational graphs and charts with data taken from [Center for Disease Control](https://covid.cdc.gov/covid-data-tracker/#vaccinations). Visualizing vaccinations can give us a better look at how close we are at gaining herd immunity and to states safely reopening.

### A look at the Total Doses administered
Here a bar graph is used to represent all states and Puerto Rico to show their total administered vaccines as of March 25, 2021. Although the graph by itself gives a good idea at the current magnitude of the vaccination effort, it fails to provide us with an idea of how close we are to reopening. 

For this reason I have added a color coding to graph representing the percentage of people with at least one vaccine for each state. This helps us see that although some states have administered a massive amounts of vaccines they might be more behind in covering their entire population.

```{r message=FALSE, echo=FALSE}
t <- read(1)
Vaccines <- suppressWarnings(stateselect(t))
Vaccines %>% mutate(state = reorder(state, total_a)) %>% 
  ggplot(aes(state,total_a, fill = one_dose_percent)) + geom_col() + 
  scale_y_continuous(name = "Total Administered Vaccines",labels = addUnits)+ 
  theme(axis.text.y = element_text(size = 6.5),legend.title = element_text(size = 8,face = "bold"),
        plot.caption = element_text(size = 5.5))+
  coord_flip()+ labs(title = "Total Doses administered in the U.S by State/Territory (March 25, 2021)",
       caption = "Data Source: The Center for Disease Control", 
       x = "States/Territory", fill = "% at least one dose") +
  geom_text(aes(label = addUnits(total_a)),size = 2.5, hjust = -0.05)
```





```{r pressure, echo=FALSE}
```


